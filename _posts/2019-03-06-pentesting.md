---
layout: post
title: Pentesting
subtitle: A list of useful references and commands for pentesting
---

This post contains a bunch of tool usage snippets and some personal thoughts on the pentesting process.

# Information Gathering

## Nmap

- Most useful Nmap option:

```bash
nmap -h | grep <anything>
```

Sorry for that one... But seriously, the help output on Nmap is very useful, but VERY verbose. Most of the time, your `nmap` commands are going to be pretty intense, so knowing how to find different options is necessary for this tool.

- Example Usage:

```bash
# Verbose Output, Service/Version info, SYN Scan, T<0-5> faster execution
nmap -v -sV -sS -T4 <target>
```
+
- Specifying Ports:

```bash
# You can specify what most-used ports you want to scan
nmap --top-ports=20 <target>
# You can also specify ALL ports
nmap -p- <target>
# A list
nmap -p 21,80,443,31337 <target>
```

- Script Scans (FTP example):
	- Scripts located in at: `/usr/share/nmap/scripts/` or just run `locate *.nse`

```bash
# You can use 
locate *ftp*.nse # Or use find if that's your thing
nmap -p 21 --script=<script> <target>
nmap -p 21 --script=ftp-* <target>
```

- Other Useful Options:

```bash
# Aggressive (enables OS detection, version detection, script scanning, and traceroute...) Pretty beefy, so probably use -v or apt-get some patience, because it'll probably take awhile
nmap -v -A <target>
# OS Detection
nmap -v -O <target>
# Default Script Scan
nmap -v -sC <target>
```

- Using Nmap over Proxychains:
	- So Proxychains is used to encapsulate TCP network traffic over a tunnel, so other protocols won't work (like ICMP with ping sweeps). Use the following syntax if you're running a scan over an SSH tunnel while pivoting through a network:

```bash
proxychains nmap -Pn -sT <target>
```

## Unicornscan

- Unicorn scan is a little faster at simply finding open ports sometimes:

```bash
unicornscan -p -a <target>
```

## Masscan

Exceptionally faster than `nmap` and `unicornscan`.

```bash
# Scan a range of ports over many hosts
masscan -p80,8000-8100 10.0.0.0/8
```

## Bscan

Go check out [bscan](https://github.com/welchbj/bscan). It runs a few well-known scanning tools that are native to Kali Linux and logically organizes the tool outputs into a directory and file structure based on the host and type of scan. Here's a basic syntax:

```bash
bscan --verbose-status --max-concurrency 5 <IP/target>
```

## HTTP Scanning

- `dirb` is a web directory brute forcer. Very useful for finding directories to probe on web apps

```bash
dirb <target>
```

- `nikto` scans for vulnerabilities and other helpful information

```bash
nikto -h <target> -p <port>
```

- `cewl` is a web scraper that makes wordlists for you. Pretty useful for conducting intellegent dictionary attacks

```bash
cewl -w <outputfile> <target>
```

- `wpscan` scans WordPress sites

```bash
# Looks for plugins
wpscan --url <target> --enumerate -p
```

### TODO
- SMB/SAMBA
- FTP
- SQL
- RPC
- DNS
- SMTP
- SNMP
- NFS

# Identifying Vulnerabilities

- <https://google.com>. Seriously, just google **everything**.

- <https://exploit-db.com>. You can go to the Exploit DB website (usually through a link on Google after searching for a vulnerable app)

- Or you can use the Kali local version called `searchsploit`

```bash
# You can also pipe this output to grep to search more precisely 
searchsploit <description/version numbers>
```

# Initial Access

## Brute Forcing

- `nmap`
- `john`
- `hydra`
- `medusa` is a web

## Web Apps

- `burpsuite`

### LFI / RFI

### Reverse Shells

Method:
1. Use your limited RCE to enumerate the scripting languages you can leverage.
2. Try shells from the following that match what is available on the target.

- perl
- bash
- netcat
- kali webshells
- ruby
- php

## Generating Payloads

- `msfvenom`

# Privilege Escalation

## Linux
- gotm1lk blog

## Windows
- windows priv esc blog

### Compiling Windows Exploits on Windows

# Pivoting

## SSH Tunnels

### Local Port Forwarding

### Remote Port Forwarding

### Dynamic Port Forwarding

# Useful Command Line Utilities

## File Searches

## User Permissions

## Firewall Rules

## File Sharing

## File Formatting Issues

- `dos2unix`

# OSCP Thoughts

- Mindset
	- Determination
- Buffer Overflows
- Process

## Metasploit bleh

Useful Commands: